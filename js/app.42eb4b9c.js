(function(e){function t(t){for(var n,o,s=t[0],u=t[1],c=t[2],p=0,f=[];p<s.length;p++)o=s[p],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);l&&l(t);while(f.length)f.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,s=1;s<r.length;s++){var u=r[s];0!==a[u]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},a={app:0},i=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var l=u;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";var n=r("85ec"),a=r.n(n);a.a},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=r("9955"),i=r.n(a),o=r("2ef0"),s=r.n(o),u=r("313e"),c=r.n(u),l=r("5c96"),p=r.n(l);r("0fae");n["default"].use(p.a,{size:"small"});r("15f5");var f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-container",[r("el-header",[r("el-button-group",[e.simulator.meta.state===e.simulator.STATE.PAUSE?r("el-button",{attrs:{type:"primary",icon:"fa fa-fw fa-play",title:"推演"},on:{click:function(t){return t.stopPropagation(),e.play(t)}}}):r("el-button",{attrs:{type:"primary",icon:"fa fa-fw fa-pause",title:"暂停"},on:{click:function(t){return t.stopPropagation(),e.pause(t)}}}),r("el-button",{style:e.forward?"color: red":"",attrs:{type:"default",icon:"fa fa-fw fa-forward",title:"快进"},on:{click:function(t){t.stopPropagation(),e.forward=!e.forward}}}),r("el-button",{attrs:{disabled:e.simulator.meta.state!==e.simulator.STATE.PAUSE,type:"default",icon:"fa fa-fw fa-step-forward",title:"步进"},on:{click:function(t){return t.stopPropagation(),e.tick(t)}}}),r("el-button",{attrs:{type:"default",icon:"fa fa-fw fa-undo",title:"重置"},on:{click:function(t){return t.stopPropagation(),e.reset(t)}}}),r("el-button",{attrs:{disabled:"",type:"default",icon:"fa fa-fw fa-save",title:"方案"}}),r("el-button",{attrs:{disabled:"",type:"default",icon:"fa fa-fw fa-book",title:"资料"}})],1),e._v(" "),r("el-radio-group",{model:{value:e.automate,callback:function(t){e.automate=t},expression:"automate"}},[r("el-radio-button",{attrs:{label:!1}},[e._v("手动")]),r("el-radio-button",{attrs:{label:!0}},[e._v("自动")])],1),e._v(" "),r("el-input",{staticStyle:{width:"auto","vertical-align":"middle"},attrs:{readonly:""},model:{value:e.simulator.meta.elapse,callback:function(t){e.$set(e.simulator.meta,"elapse",t)},expression:"simulator.meta.elapse"}},[r("template",{slot:"prepend"},[e._v("时间")])],2),r("el-divider")],1),r("el-aside",{staticStyle:{width:"auto"}},[r("el-form",{staticStyle:{"max-width":"900px"}},[r("el-form-item",{attrs:{label:"应急资源"}},[r("el-table",{attrs:{data:e.simulator.station.engine.types}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-table",{attrs:{data:e.typedEngines(t.row.type)}},[r("el-table-column",{attrs:{label:"编号",prop:"name"}}),r("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.simulator.station.engine.stateNames[t.row.state])+" ")]}}],null,!0)}),r("el-table-column",{attrs:{label:"目标",prop:"cruise.dst"}}),r("el-table-column",{attrs:{label:"行程"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.cruiseProgress(t.row))+"% ")]}}],null,!0)})],1)]}}])}),r("el-table-column",{attrs:{label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{model:{value:t.row.type,callback:function(r){e.$set(t.row,"type",r)},expression:"scope.row.type"}})]}}])}),r("el-table-column",{attrs:{label:"流量（L/s）"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{readonly:!e.prepare},nativeOn:{mousewheel:function(r){return e.wheelChange(r,t.row,"flow",1,10,60)}},model:{value:t.row.flow,callback:function(r){e.$set(t.row,"flow",e._n(r))},expression:"scope.row.flow"}})]}}])}),r("el-table-column",{attrs:{label:"储量（L）"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{readonly:!e.prepare},nativeOn:{mousewheel:function(r){return e.wheelChange(r,t.row,"capacity",50,5e3,3e4)}},model:{value:t.row.capacity,callback:function(r){e.$set(t.row,"capacity",e._n(r))},expression:"scope.row.capacity"}})]}}])}),r("el-table-column",{attrs:{label:"速度（km/s）"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{readonly:!e.prepare},nativeOn:{mousewheel:function(r){return e.wheelChange(r,t.row,"speed",5,10,120)}},model:{value:t.row.speed,callback:function(r){e.$set(t.row,"speed",e._n(r))},expression:"scope.row.speed"}})]}}])}),r("el-table-column",{attrs:{label:"准备时间（分）"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{readonly:!e.prepare},nativeOn:{mousewheel:function(r){return e.wheelChange(r,t.row,"prepare",1,1,30)}},model:{value:t.row.prepare,callback:function(r){e.$set(t.row,"prepare",e._n(r))},expression:"scope.row.prepare"}})]}}])}),r("el-table-column",{attrs:{label:"可用数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{readonly:!e.prepare},nativeOn:{mousewheel:function(r){return e.wheelChange(r,t.row,"amount",1,5,50)}},model:{value:t.row.amount,callback:function(r){e.$set(t.row,"amount",e._n(r))},expression:"scope.row.amount"}})]}}])}),r("el-table-column",{attrs:{width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{icon:"fa fa-fw fa-plus",type:"success",disabled:!e.prepare},on:{click:function(r){return r.stopPropagation(),e.simulator.station.engine.copyType(t.row.type)}}}),r("el-button",{attrs:{icon:"fa fa-fw fa-minus",type:"danger",disabled:!e.prepare||e.simulator.station.engine.types.length<2},on:{click:function(r){return r.stopPropagation(),e.simulator.station.engine.dropType(t.row.type)}}})]}}])})],1)],1),r("el-form-item",{attrs:{label:"承灾载体"}},[r("el-table",{attrs:{data:e.simulator.airport.aircraft.types}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-table",{attrs:{data:e.typedAircrafts(t.row.type)}},[r("el-table-column",{attrs:{label:"编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}],null,!0)}),r("el-table-column",{attrs:{label:"耐久"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.durability)+" ")]}}],null,!0)}),r("el-table-column",{attrs:{label:"位置",width:"240px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{staticStyle:{width:"100px"},nativeOn:{mousewheel:function(r){e.wheelChange(r,e.simulator.map.get(t.row.name),"x",5,200,1e3)}},model:{value:e.simulator.map.get(t.row.name)["x"],callback:function(r){e.$set(e.simulator.map.get(t.row.name),"x",e._n(r))},expression:"simulator.map.get(scope.row.name)['x']"}},[r("template",{slot:"prepend"},[e._v("x:")])],2),e._v(" "),r("el-input",{staticStyle:{width:"100px"},nativeOn:{mousewheel:function(r){e.wheelChange(r,e.simulator.map.get(t.row.name),"y",5,200,1e3)}},model:{value:e.simulator.map.get(t.row.name)["y"],callback:function(r){e.$set(e.simulator.map.get(t.row.name),"y",e._n(r))},expression:"simulator.map.get(scope.row.name)['y']"}},[r("template",{slot:"prepend"},[e._v("y:")])],2)]}}],null,!0)}),r("el-table-column",{attrs:{label:"资源"}},[void 0],2),r("el-table-column",{attrs:{width:"160px"}})],1)]}}])}),r("el-table-column",{attrs:{label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{readonly:!e.prepare},on:{input:function(r){return e.aircraftTypeUpdate(t.row.typeId,"type",r)}},model:{value:t.row.type,callback:function(r){e.$set(t.row,"type",r)},expression:"scope.row.type"}})]}}])}),r("el-table-column",{attrs:{label:"耐久"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{readonly:!e.prepare},on:{input:function(r){return e.aircraftTypeUpdate(t.row.typeId,"durability",r)}},nativeOn:{mousewheel:function(r){return e.wheelChange(r,t.row,"durability",100,2e5,1e6,"aircraftType")}},model:{value:t.row.durability,callback:function(r){e.$set(t.row,"durability",e._n(r))},expression:"scope.row.durability"}})]}}])}),r("el-table-column",{attrs:{label:"数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{readonly:!e.prepare},on:{input:function(r){return e.aircraftTypeUpdate(t.row.typeId,"amount",r)}},nativeOn:{mousewheel:function(r){return e.wheelChange(r,t.row,"amount",1,1,10,"aircraftType")}},model:{value:t.row.amount,callback:function(r){e.$set(t.row,"amount",e._n(r))},expression:"scope.row.amount"}})]}}])}),r("el-table-column",{attrs:{width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{icon:"fa fa-fw fa-plus",type:"success",disabled:!e.prepare},on:{click:function(r){return r.stopPropagation(),e.simulator.copyAircraftType(t.row.type)}}}),r("el-button",{attrs:{icon:"fa fa-fw fa-minus",type:"danger",disabled:!e.prepare||e.simulator.airport.aircraft.types.length<2},on:{click:function(r){return r.stopPropagation(),e.simulator.dropAircraftType(t.row.type)}}})]}}])})],1)],1),r("el-form-item",{attrs:{label:"突发事件"}},[r("el-table",{attrs:{data:e.simulator.disaster.disasters}},[r("el-table-column",{attrs:{width:"48px"}}),r("el-table-column",{attrs:{label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-select",{attrs:{readonly:!e.prepare},model:{value:t.row.type,callback:function(r){e.$set(t.row,"type",r)},expression:"scope.row.type"}},e._l([{type:"fire",name:"火灾"}],(function(e){return r("el-option",{key:e.type,attrs:{label:e.name,value:e.type}})})),1)]}}])}),r("el-table-column",{attrs:{label:"位置"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.target)+" ")]}}])}),r("el-table-column",{attrs:{label:"形势"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{readonly:!e.prepare},nativeOn:{mousewheel:function(r){return e.wheelChange(r,t.row,"power",10,200,3e3)}},model:{value:t.row.power,callback:function(r){e.$set(t.row,"power",e._n(r))},expression:"scope.row.power"}})]}}])}),r("el-table-column",{attrs:{label:"趋势"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{readonly:!e.prepare},nativeOn:{mousewheel:function(r){return e.wheelChange(r,t.row,"growth",5,50,200)}},model:{value:t.row.growth,callback:function(r){e.$set(t.row,"growth",e._n(r))},expression:"scope.row.growth"}})]}}])}),r("el-table-column",{attrs:{width:"160px"}})],1)],1)],1)],1),r("el-main",[r("div",{staticStyle:{width:"800px",height:"320px"},attrs:{id:"chartFirePower"}}),r("div",{staticStyle:{width:"800px",height:"320px"},attrs:{id:"chartFireGrowth"}}),r("div",{staticStyle:{width:"800px",height:"320px"},attrs:{id:"chartEngineState"}}),r("div",{staticStyle:{width:"800px",height:"320px"},attrs:{id:"chartEngineCapacity"}}),r("div",{staticStyle:{width:"800px",height:"320px"},attrs:{id:"chartAircraftDurabitliy"}})])],1)],1)},d=[],y=(r("4de4"),r("7db0"),r("4160"),r("caad"),r("c975"),r("d81d"),r("b0c0"),r("a9e3"),r("d3b7"),r("2532"),r("159b"),r("ddb0"),r("c740"),r("13d5"),r("fb6a"),r("a434"),r("2909")),m=[],h={disasters:m,reset:function(){m.splice(0)},fire:{set:function(e,t,r){m.push({type:"fire",target:e,power:t,growth:r})},get:function(e){var t=m.find((function(t){return t.target===e}));return t||{type:"fire",target:e,power:0,growth:0}}}},g=(r("4d63"),r("ac1f"),r("25f0"),r("466d"),r("5530")),w={name:"STATION"},b={STATE:{IDLE:0,PREPARE:1,CRUISE:2,WORK:3,STANDBY:4},engines:[],types:[],mappedTypes:{}},v=Object(g["a"])({},w,{reset:function(){for(var e in b.engines.splice(0),b.types.splice(0),b.mappedTypes)delete b.mappedTypes[e]},engine:Object(g["a"])({},b,{stateNames:{0:"空闲",1:"准备",2:"巡航",3:"工作",4:"待命"},setupType:function(e,t,r,n,a,i,o){var s={type:e,flow:t,capacity:r,speed:n,prepare:a,cost:i,amount:o};b.types.push(s),b.mappedTypes[e]=s},copyType:function(e){var t=e,r=b.types.find((function(t){return t.type===e})),n=b.types.findIndex((function(t){return t.type===e})),a=e.match(/-\d+$/);a&&(t=e.substring(0,a.index));var i=new RegExp(t+"(-\\d+)?$"),o=b.types.filter((function(e){return i.test(e.type)})).length;return b.types.forEach((function(e){var t=e.type.match(i);if(t&&t.length>1&&t[1]){var r=Number(t[1].substring(1));r>o&&(o=r)}})),r=Object(g["a"])({},r,{type:t+"-"+(o+1)}),b.types.splice(n+1,0,r),b.mappedTypes[r.type]=r,r.type},dropType:function(e){b.types.splice(b.types.findIndex((function(t){return t.type===e})),1)},buildInstance:function(e){var t=b.engines.filter((function(t){return t.type===e})),r=new RegExp(e+"(-\\d+)?$"),n=t.length;t.forEach((function(e){var t=e.name.match(r);if(t&&t.length>1&&t[1]){var a=Number(t[1].substring(1));a>n&&(n=a)}}));var a=e+"-"+String((n+1)/1e3).substring(2);return b.engines.push(Object(g["a"])({name:a,state:b.STATE.IDLE,cruise:{src:"",dst:""},elapsed:0},b.mappedTypes[e])),a}})}),x={name:"AIRPORT"},T={aircrafts:[],types:[],mappedTypes:{}},S=Object(g["a"])({},x,{reset:function(){for(var e in T.aircrafts.splice(0),T.types.splice(0),T.types)delete T.types[e]},aircraft:Object(g["a"])({},T,{setupType:function(e,t,r,n){var a={type:e,area:t,durability:r,amount:n,typeId:_.uniqueId()};T.types.push(a),T.mappedTypes[e]=a},copyType:function(e){var t=e,r=T.types.find((function(t){return t.type===e})),n=T.types.findIndex((function(t){return t.type===e})),a=e.match(/-\d+$/);a&&(t=e.substring(0,a.index));var i=new RegExp(t+"(-\\d+)?$"),o=T.types.filter((function(e){return i.test(e.type)})).length;return T.types.forEach((function(e){var t=e.type.match(i);if(t&&t.length>1&&t[1]){var r=Number(t[1].substring(1));r>o&&(o=r)}})),r=Object(g["a"])({},r,{type:t+"-"+(o+1),typeId:_.uniqueId()}),T.types.splice(n+1,0,r),T.mappedTypes[r.type]=r,r.type},dropType:function(e){T.types.splice(T.types.findIndex((function(t){return t.type===e})),1)},buildInstance:function(e){var t=T.aircrafts.filter((function(t){return t.type===e})),r=new RegExp(e+"(-\\d+)?$"),n=t.length;t.forEach((function(e){var t=e.name.match(r);if(t&&t.length>1&&t[1]){var a=Number(t[1].substring(1));a>n&&(n=a)}}));var a=e+"-"+String((n+1)/1e3).substring(2);return T.aircrafts.push(Object(g["a"])({name:a},T.mappedTypes[e])),a},dropInstance:function(e){return e?T.aircrafts.splice(T.aircrafts.findIndex((function(t){return t.name===e})),1):T.aircrafts.splice(-1)}})}),E=r("53ca"),A={},k=[],O={map:A,list:k,reset:function(){for(var e in A)delete A[e];k.splice(0)},set:function(e,t,r){var n={name:e,x:t,y:r};A[e]=n,k.push(n)},get:function(e){return A[e]},distance:function(e,t){"object"===Object(E["a"])(e)&&(e=e.name),"object"===Object(E["a"])(t)&&(t=t.name);var r=[A[e],A[t]],n=r[0],a=r[1];return n&&a?Math.sqrt(Math.pow(n.x-a.x,2)+Math.pow(n.y-a.y,2)):-1}},P={PAUSE:0,PLAY:1},I={cost:0,state:P.PAUSE,elapse:0,scheme:{}},$={STATE:P,disaster:h,station:v,airport:S,map:O,meta:I,survival:0,danger:0,history:{timeline:[],firePower:[],fireGrowth:[],engineState:[],engineCapacity:[],aircraftDurability:[]},reset:function(){h.reset(),v.reset(),S.reset(),O.reset(),_.values(history).forEach((function(e){return e.splice(0)})),I.cost=0,I.state=P.PAUSE,I.elapse=0,I.scheme=this.randomScheme()},record:function(){var e,t,r,n,a;0===this.history.firePower.length&&((e=this.history.firePower).push.apply(e,Object(y["a"])(h.disasters.map((function(e){return{type:"line",name:e.target,stack:"power",data:[]}})))),(t=this.history.fireGrowth).push.apply(t,Object(y["a"])(h.disasters.map((function(e){return{type:"line",name:e.target,data:[]}})))),(r=this.history.engineState).push.apply(r,Object(y["a"])(_.map(v.engine.STATE,(function(e){return{type:"line",name:v.engine.stateNames[e],value:e,stack:"amount",data:[]}})))),(n=this.history.engineCapacity).push.apply(n,Object(y["a"])(v.engine.types.map((function(e){return{type:"line",name:e.type,stack:"capacity",data:[]}})))),(a=this.history.aircraftDurability).push.apply(a,Object(y["a"])(S.aircraft.aircrafts.map((function(e){return{type:"line",name:e.name,data:[]}})))));this.history.firePower.forEach((function(e){e.data.push(h.disasters.find((function(t){return t.target===e.name})).power)})),this.history.fireGrowth.forEach((function(e){var t=h.disasters.find((function(t){return t.target===e.name}));e.data.push(t.trend||t.growth)})),this.history.engineState.forEach((function(e){e.data.push(v.engine.engines.filter((function(t){return t.state===e.value})).length)})),this.history.engineCapacity.forEach((function(e){e.data.push(_.reduce(v.engine.engines.filter((function(t){return t.type===e.name})),(function(e,t){return e+t.capacity}),0))})),this.history.aircraftDurability.forEach((function(e){e.data.push(S.aircraft.aircrafts.find((function(t){return t.name===e.name})).durability)})),this.history.timeline.push(this.history.timeline.length)},tick:function(){var e=this;if(0===I.elapse){this.survival=S.aircraft.aircrafts.length,this.danger=S.aircraft.aircrafts.length,v.engine.types.forEach((function(e){for(var t=0;t<e.amount;t++){var r=O.get(v.name);O.set(v.engine.buildInstance(e.type),r.x,r.y)}})),e.record();var t=Math.max.apply(Math,Object(y["a"])(v.engine.types.map((function(e){return e.prepare})))),r=Math.min.apply(Math,Object(y["a"])(v.engine.types.map((function(e){return e.speed})))),n=Math.max.apply(Math,Object(y["a"])(v.engine.types.map((function(e){return e.flow})))),a=Math.min.apply(Math,Object(y["a"])(v.engine.types.map((function(e){return e.capacity})))),i=S.aircraft.aircrafts.map((function(i){var o=O.distance(i,v),s=e.disaster.disasters.find((function(e){return e.target===i.name})),u=t+o/r,c=s.power+s.growth*u,l=(s.power+c)*u/2,p=Math.min(Math.floor(2*(i.durability-l)/c-1),Math.floor(a/n)),f=c/p,d=c*p,y=_.mapValues(v.engine.mappedTypes,(function(){return 0}));return{aircraft:i,distance:o,disaster:s,maxLeadTime:u,maxFirePower:c,maxSurvivalTime:p,minFlow:f,minCapacity:d,scheme:y,survive:!1}})),o=function(e){return _.reduce(e,(function(e,t,r){return e+v.engine.mappedTypes[r].flow*t}),0)},s=_.mapValues(v.engine.mappedTypes,(function(){return 0})),u=function(e){return _.reduce(e,(function(e,t,r){return e+v.engine.mappedTypes[r].capacity*t}),0)};i.forEach((function(e){var t=o(e.scheme),r=u(e.scheme);v.engine.types.forEach((function(n){while((e.minFlow>t||e.minCapacity>r)&&e.scheme[n.type]+s[n.type]<n.amount)e.scheme[n.type]+=1,t+=n.flow,r+=2*n.capacity})),_.forEach(e.scheme,(function(e,t){return s[t]+=e})),(e.minFlow<t||e.minCapacity<r)&&(e.survive=!0)})),i.forEach((function(e){console.log("ac: "+e.aircraft.name),console.log(e.scheme),_.forEach(e.scheme,(function(t,r){v.engine.engines.filter((function(e){return e.state!==v.engine.STATE.PREPARE})).filter((function(e){return e.type===r})).slice(0,t).forEach((function(t){t.state=v.engine.STATE.PREPARE,t.cruise.src=v.name,t.cruise.dst=e.aircraft.name}))}))}))}h.disasters.forEach((function(e){return e.trend=e.growth})),v.engine.engines.filter((function(e){return e.state===v.engine.STATE.WORK})).forEach((function(e){var t=S.aircraft.aircrafts.find((function(t){return t.name===e.cruise.dst})),r=h.fire.get(t.name);r.power>e.flow?(r.power-=e.flow,r.trend-=e.flow,e.capacity-=e.flow):(r.power=0,r.trend=0,r.growth=0,e.state=v.engine.STATE.STANDBY)})),v.engine.engines.filter((function(e){return e.state===v.engine.STATE.CRUISE})).forEach((function(e){var t=O.get(e.name),r=O.get(e.cruise.dst);O.distance(e,e.cruise.dst)>e.speed?(O.get(e.name).x+=(r.x-t.x)*e.speed/O.distance(e,e.cruise.dst),O.get(e.name).y+=(r.y-t.y)*e.speed/O.distance(e,e.cruise.dst)):(r&&t||console.log(e.name),t.x=r.x,t.y=r.y,e.state=v.engine.STATE.WORK)}));var c=v.engine.engines.filter((function(e){return e.state===v.engine.STATE.PREPARE}));c.filter((function(e){return e.elapsed<e.prepare})).forEach((function(e){e.elapsed+=1}));var l=c.find((function(e){return e.elapsed===e.prepare}));l&&(l.state=v.engine.STATE.CRUISE,l.elapsed=0),h.disasters.forEach((function(e){var t=S.aircraft.aircrafts.find((function(t){return t.name===e.target}));t.durability>0&&(e.power+=e.growth)}));var p=S.aircraft.aircrafts.length,f=S.aircraft.aircrafts.length;S.aircraft.aircrafts.forEach((function(e){var t=h.disasters.find((function(t){return t.target===e.name}));t&&t.power>0&&(e.durability=Math.max(e.durability-t.power,0)),0===e.durability?(p-=1,f-=1):t&&0!==t.power||(f-=1)})),this.survival=p,this.danger=f,I.elapse+=1,this.record()},random:function(e,t){return parseInt(Math.random()*(t-e)+e,10)},randomScheme:function(){var e=this;O.set(v.name,0,1e3),v.engine.setupType("Alex",50,5e3,30,10,500,30),v.engine.setupType("Bob",80,12e3,20,15,1e3,30),S.aircraft.setupType("B747",500,8e5,1),S.aircraft.setupType("B737",500,5e5,1),S.aircraft.types.forEach((function(t){for(var r=0;r<t.amount;r++)e.buildAircraft(t.type)}))},copyAircraftType:function(e){e=S.aircraft.copyType(e),this.buildAircraft(e)},dropAircraftType:function(e){var t=this;S.aircraft.aircrafts.filter((function(t){return t.type===e})).forEach((function(e){return t.dropAircraft(e.name)})),S.aircraft.dropType(e)},buildAircraft:function(e){var t=this,r=S.aircraft.buildInstance(e);O.set(r,t.random(200,1e3),t.random(200,1e3)),h.fire.set(r,t.random(200,1e3),t.random(50,200))},dropAircraft:function(e){e=S.aircraft.dropInstance(e).name,h.disasters.splice(h.disasters.findIndex((function(t){return t.target===e})),1)}},j={PAUSE:0,PLAY:1},C={name:"app",components:{},data:function(){return document.timer=void 0,{timer:void 0,delay:500,forward:!1,automate:!1,simulator:$}},computed:{prepare:function(){return 0===$.meta.elapse&&$.meta.state===$.STATE.PAUSE},STATE:function(){return j},cruiseProgress:function(){return function(e){var t=$.map.distance(e.cruise.src,e)/$.map.distance(e.cruise.src,e.cruise.dst);return Math.floor(100*Number(String(t).substring(0,4)))}},typedEngines:function(){return function(e){return $.station.engine.engines.filter((function(t){return t.type===e})).filter((function(e){return Boolean(e.cruise.dst)}))}},typedAircrafts:function(){return function(e){return $.airport.aircraft.aircrafts.filter((function(t){return t.type===e}))}}},methods:{aircraftTypeUpdate:function(e,t){var r=$.airport.aircraft.types.find((function(t){return t.typeId===e}));if("amount"===t&&!isNaN(r.amount)&&Number(r.amount)>0){for(var n=$.airport.aircraft.aircrafts.filter((function(t){return t.typeId===e})),a=n.length;a<r.amount;a++)$.buildAircraft(r.type);for(var i=n.length;i>r.amount;i--)$.dropAircraft()}else $.airport.aircraft.aircrafts.filter((function(t){return t.typeId===e})).forEach((function(e){e[t]=r[t]}))},wheelChange:function(e,t,r,n,a,i,o){e.deltaY>0?(t[r]-=n,a&&(t[r]=Math.max(a,t[r]))):(t[r]+=n,i&&(t[r]=Math.min(i,t[r]))),"aircraftType"===o&&this.aircraftTypeUpdate(t.typeId,r)},paintChart:function(){var e=$.airport.aircraft.aircrafts.map((function(e){return e.name}));this.$echarts.init(document.getElementById("chartFirePower")).setOption({title:{text:"火势变化"},legend:{data:e},grid:{left:"100"},xAxis:{name:"时间",type:"category",boundaryGap:!1,data:$.history.timeline},yAxis:{name:"火势",type:"value"},series:$.history.firePower}),this.$echarts.init(document.getElementById("chartFireGrowth")).setOption({title:{text:"蔓延变化"},legend:{data:e},grid:{left:"100"},xAxis:{name:"时间",type:"category",boundaryGap:!1,data:$.history.timeline},yAxis:{name:"蔓延",type:"value"},series:$.history.fireGrowth}),this.$echarts.init(document.getElementById("chartEngineState")).setOption({title:{text:"救援状态"},legend:{data:_.values($.station.engine.stateNames)},grid:{left:"100"},xAxis:{name:"时间",type:"category",boundaryGap:!1,data:$.history.timeline},yAxis:{name:"状态",type:"value"},series:$.history.engineState}),this.$echarts.init(document.getElementById("chartEngineCapacity")).setOption({title:{text:"救援储备"},legend:{data:$.station.engine.types.map((function(e){return e.type}))},grid:{left:"100"},xAxis:{name:"时间",type:"category",boundaryGap:!1,data:$.history.timeline},yAxis:{name:"状态",type:"value"},series:$.history.engineCapacity}),this.$echarts.init(document.getElementById("chartAircraftDurabitliy")).setOption({title:{text:"载体耐久"},legend:{data:$.airport.aircraft.aircrafts.map((function(e){return e.name}))},grid:{left:"100"},xAxis:{name:"时间",type:"category",boundaryGap:!1,data:$.history.timeline},yAxis:{name:"状态",type:"value"},series:$.history.aircraftDurability})},reset:function(){this.pause(),$.reset()},cm:function(e){var t=String(e);return t.includes(".")?t.substr(0,t.indexOf(".")+3):t},play:function(){clearInterval(this.timer),$.meta.state=$.STATE.PLAY,this.timer=setInterval(this.tick,this.delay)},pause:function(){$.meta.state=$.STATE.PAUSE,clearInterval(this.timer),this.timer=void 0},tick:function(){$.tick(),this.forward&&$.tick(),0===$.survival?(this.pause(),this.$alert("失败！","",{type:"error"})):0===$.danger&&(this.pause(),$.survival===$.airport.aircraft.aircrafts.length?this.$alert("成功！","",{type:"success"}):this.$alert("再接再厉","",{type:"warning"})),this.paintChart()}},mounted:function(){this.simulator.reset()}},M=C,R=(r("034f"),r("2877")),U=Object(R["a"])(M,f,d,!1,null,null,null),N=U.exports;n["default"].config.productionTip=!1,n["default"].use(i.a,{lodash:s.a}),n["default"].prototype.$echarts=c.a,new n["default"]({render:function(e){return e(N)}}).$mount("#app")},"85ec":function(e,t,r){}});
//# sourceMappingURL=app.42eb4b9c.js.map